if (self.CavalryLogger) { CavalryLogger.start_js(["8wWfd"]); }

__d("FBRTCMediaMetricTracker",["performanceNow"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g={min:-1,max:-1,mean:-1,median:-1,total:-1,count:0};function h(){this.$1={},this.$2={},this.$3={}}h.prototype.getVideoStreamReportKeys=function(){return Object.keys(this.$3)};h.prototype.getJitterStreamReportKey=function(){return Object.keys(this.$1)};h.prototype.getAudioStreamReportKeys=function(){return Object.keys(this.$2)};h.prototype.addJitterBufferDelay=function(a,b){b!==null&&b!==undefined&&(this.$1[a]||(this.$1[a]=[]),this.$1[a].push(b))};h.prototype.setVideoMetric=function(a,c,d){d!==null&&d!==undefined&&(this.$3[a]||(this.$3[a]={}),!this.$3[a][c]?this.$3[a][c]={first:d,startedTime:b("performanceNow")(),current:d,updatedTime:b("performanceNow")()}:(this.$3[a][c].current=d,this.$3[a][c].updatedTime=b("performanceNow")()))};h.prototype.getVideoMetric=function(a,b){return this.$3[a]?this.$3[a][b]:null};h.prototype.addMetricStat=function(a,b,c){c!==null&&c!==undefined&&(this.$2[a]||(this.$2[a]={}),!this.$2[a][b]?this.$2[a][b]={min:c,max:c,total:c,count:1,mean:c}:(this.$2[a][b].total+=c,this.$2[a][b].count+=1,this.$2[a][b].min=Math.min(this.$2[a][b].min,c),this.$2[a][b].max=Math.max(this.$2[a][b].max,c),this.$2[a][b].mean=this.$2[a][b].total/this.$2[a][b].count))};h.prototype.getMetricKeys=function(a){return!this.$2[a]?[]:Object.keys(this.$2[a])};h.prototype.getMetricStats=function(a,b){return!this.$2[a]?null:this.$2[a][b]};h.prototype.getJitterBufferStats=function(a){__p&&__p();if(!this.$1[a])return g;var b=this.$1[a].length;if(b===0)return g;this.$1[a].sort(function(a,b){return a-b});var c=this.$1[a].reduce(function(a,b){return a+b});if(b%2===0){var d=Math.floor((b-1)/2),e=Math.ceil((b-1)/2);d=(this.$1[a][d]+this.$1[a][e])/2}else d=this.$1[a][(b-1)/2];return{max:this.$1[a][b-1],min:this.$1[a][0],mean:c/b,median:d,total:c,count:b}};h.prototype.toJsonString=function(){return JSON.stringify({stats:this.$2,jitterBufferDelays:this.$1,videoMetric:this.$3})};h.fromJsonString=function(a){var b=new h();try{a=JSON.parse(a),a=a}catch(a){return b}a.stats&&(b.$2=a.stats);a.jitterBufferDelays&&(b.$1=a.jitterBufferDelays);a.videoMetric&&(b.$3=a.videoMetric);return b};e.exports=h}),null);