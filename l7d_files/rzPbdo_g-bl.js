if (self.CavalryLogger) { CavalryLogger.start_js(["IL7JT"]); }

__d("FBRTCScreenSharingUtils",["Promise","FBRTCExperiment","FBRTCScreenSharingLogger","FBRTCStruct","FBRTCSupport","FBRTCVersionDetection","RTCConfig"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=new(b("FBRTCStruct"))(["UNKNOWN","INSTALLED"]),h=g.UNKNOWN,i={RECIPIENT:"SC_CONTENT_SCRIPT",isScreenSharingSupportedV1:function(){return b("RTCConfig").ScreenSharingGK},isScreenSharingSupported:function(){if(b("RTCConfig").ScreenSharingGK)return!0;var a=b("FBRTCExperiment").gen("webrtc_enable_screen_sharing");return a.getBool("can_screen_sharing",!1)},isGroupCallScreenSharingSupported:function(){return b("RTCConfig").ScreenSharingToGroupGK},isSupportedBrowser:function(){return b("FBRTCVersionDetection").isChrome()&&b("FBRTCVersionDetection").webrtcVersion()>=34},canUserReceiveScreenSharing:function(){return b("FBRTCSupport").isOSSupported()&&b("FBRTCVersionDetection").isChromium()&&b("FBRTCVersionDetection").webrtcVersion()>=34},canPeerReceiveScreenSharing:function(a){if(a.remoteSupport("screen_sharing"))return!0;if(!a.remoteSupport("www")&&!a.remoteSupport("mweb")){if(b("RTCConfig").ScreenSharingToMobileGK)return!0;a=b("FBRTCExperiment").gen("webrtc_enable_screen_sharing");return a.getBool("can_share_to_mobile",!1)}return!1},isExtensionInstalled:function(){return h===g.INSTALLED},getExtensionStatus:function(){return h},checkExtensionInstalled:function(){__p&&__p();if(this.isExtensionInstalled())return b("Promise").resolve();var a,c=new(b("Promise"))(function(b){a=function(c){var d=c.origin;c=c.data;if(d!=window.location.origin||!c.type)return;c.type==="SC_EXT_INSTALLED"&&(window.removeEventListener("message",a),h=g.INSTALLED,b())},window.addEventListener("message",a)});return b("Promise").race([c,this._pokeExtension()])["catch"](function(c){window.removeEventListener("message",a);return b("Promise").reject(c)})},_pokeExtension:function(a){a===void 0&&(a=13);return new(b("Promise"))(function(b,c){var d=setInterval(function(){setTimeout(function(){h===g.UNKNOWN&&window.postMessage({recipient:i.RECIPIENT,type:"SC_IS_EXT_INSTALLED",text:"is extension installed"},"*")}),a>0?a--:(clearInterval(d),c("extension unavailable"))},200)})},logFailedAttempt:function(a,c){b("FBRTCScreenSharingLogger").getInstance().logAction(a,c,b("FBRTCScreenSharingLogger").Action.SCREEN_SHARING_TOGGLED,"feature not available")}};e.exports=i}),null);