if (self.CavalryLogger) { CavalryLogger.start_js(["B4U51"]); }

__d("AdsCFAdgroupUnsupportedPlacementValidator",["fbt","AdsAbstractValidator","AdsAPIAccountPaths","AdsAPIAdgroupPaths","AdsAPICampaignGroupPaths","AdsAPIFacebookPosition","AdsAPIOptimizationGoals","AdsAPIPublisherPlatform","AdsAPITargetFields","AdsCanvasAdUtils","AdsError","AdsErrorType_DEPRECATED","AdsImageConstants","AdsPlacementAPISpecReaderUtils","AdsPlacementPlugins","AdsPlacementUIUtils","MarketplaceAdsUtil","expandPaths","intlList","nullthrows"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;h=babelHelpers.inherits(a,b("AdsAbstractValidator"));h&&h.prototype;a.prototype.getDependencies=function(){return{account:b("expandPaths")([b("AdsAPIAccountPaths").CAPABILITIES]),accountBlockLists:undefined,adgroup:b("expandPaths")([].concat([b("AdsAPIAdgroupPaths").CREATIVE.IMAGE_CROPS,b("AdsAPIAdgroupPaths").CREATIVE.INSTAGRAM_ACTOR_ID,b("AdsAPIAdgroupPaths").CREATIVE.OBJECT_TYPE,b("AdsAPIAdgroupPaths").CREATIVE.STORY_ID,b("AdsAPIAdgroupPaths").CREATIVE.OBJECT_STORY_ID,b("AdsAPIAdgroupPaths").CREATIVE.OBJECT_STORY_SPEC.INSTAGRAM_ACTOR_ID,b("AdsAPIAdgroupPaths").CREATIVE.OBJECT_STORY_SPEC.LINK_DATA.CHILD_ATTACHMENTS,b("AdsAPIAdgroupPaths").CREATIVE.OBJECT_STORY_SPEC.LINK_DATA.IMAGE_CROPS,b("AdsAPIAdgroupPaths").CREATIVE.OBJECT_STORY_SPEC.LINK_DATA.LINK,b("AdsAPIAdgroupPaths").CREATIVE.OBJECT_STORY_SPEC.PAGE_ID,b("AdsAPIAdgroupPaths").CREATIVE.OBJECT_STORY_SPEC.VIDEO_DATA.VIDEO_ID,b("AdsAPIAdgroupPaths").CREATIVE.OBJECT_STORY_SPEC.VIDEO_DATA.CALL_TO_ACTION.VALUE.LINK,b("AdsAPIAdgroupPaths").CREATIVE.PLATFORM_CUSTOMIZATIONS.path],b("AdsImageConstants").IMAGE_HASH_PATHS,b("AdsImageConstants").IMAGE_URL_PATHS)),campaignGroup:b("expandPaths")([b("AdsAPICampaignGroupPaths").BUYING_TYPE,b("AdsAPICampaignGroupPaths").OBJECTIVE]),eligibilityInfo:null,ineligiblePlacementSpec:undefined}};a.prototype.shouldValidate=function(a){__p&&__p();a.account;a.accountBlockLists;var c=a.adgroup;a.campaign;a.campaignGroup;var d=a.eligibilityInfo;a=a.ineligiblePlacementSpec;if(!d)return!1;var e=d.spec;if(!a||!a[b("AdsAPITargetFields").PUBLISHER_PLATFORMS]||a[b("AdsAPITargetFields").PUBLISHER_PLATFORMS].length===0||!e[b("AdsAPITargetFields").PUBLISHER_PLATFORMS]||e[b("AdsAPITargetFields").PUBLISHER_PLATFORMS].length===0)return!1;a=i(a,d);if(b("AdsPlacementAPISpecReaderUtils").isOnlyActivePublisherPlatform(a,b("AdsAPIPublisherPlatform").INSTAGRAM)&&!b("AdsPlacementAPISpecReaderUtils").isOnlyActivePublisherPlatform(e,b("AdsAPIPublisherPlatform").INSTAGRAM))return!1;if(b("AdsCanvasAdUtils").isCanvasAd(c.creative))return!1;return d.optimizationGoal===b("AdsAPIOptimizationGoals").TWO_SECOND_CONTINUOUS_VIDEO_VIEWS||d.optimizationGoal===b("AdsAPIOptimizationGoals").COMPLETED_VIDEO_VIEWS||d.optimizationGoal===b("AdsAPIOptimizationGoals").VIDEO_VIEWS_15S?!1:!0};a.prototype.validate=function(a){__p&&__p();a.adgroup;var c=a.eligibilityInfo;a=a.ineligiblePlacementSpec;if(!c)return[];var d=[],e=i(a,c);a=Object.keys(e).some(function(a){return!!e[a]&&e[a].length>0});if(!a)return d;a=b("AdsPlacementUIUtils").getFriendlyPlacementListing(babelHelpers["extends"]({},c,{spec:e}));d.push(new(b("AdsError"))(b("AdsErrorType_DEPRECATED").ADGROUP_UNSUPPORTED_PAGE_TYPES,g._({"*":"The media you've chosen for your ad creative isn't supported in some of your ad set placements. Edit your ad set to remove {unsupported placements} as placements, create a new ad set for this ad, or change the image or video in your ad.","_1":"The media you've chosen for your ad creative isn't supported in some of your ad set placements. Edit your ad set to remove {unsupported placements} as placement, create a new ad set for this ad, or change the image or video in your ad."},[g._param("unsupported placements",b("intlList")(a.toJS())),g._plural(a.size)]),{level:b("AdsError").Level.WARN,path:undefined}));return d};function a(){h.apply(this,arguments)}function i(a,c){__p&&__p();var d=b("nullthrows")(a);if(!b("MarketplaceAdsUtil").isTargetingEligible(c)){a=d.facebook_positions;if(a&&a.length>0){var e=new Set(a);e.has(b("AdsAPIFacebookPosition").MARKETPLACE)&&(d.facebook_positions=a.filter(function(a){return a!==b("AdsAPIFacebookPosition").MARKETPLACE}))}}var f=c.spec,g=new Set(f[b("AdsAPITargetFields").PUBLISHER_PLATFORMS]),h=new Set(d[b("AdsAPITargetFields").PUBLISHER_PLATFORMS]),i={};b("AdsPlacementPlugins").getOrderedPlatforms(c).toJS().forEach(function(a){__p&&__p();if(!g.has(a.apiPublisherPlatform)||!h.has(a.apiPublisherPlatform))return;var b=a.apiPositionsTargetField?a.apiPositionsTargetField(c.capabilities):null;if(!b||!d[b]&&!f[b]){j(i,a.apiPublisherPlatform);return}if(d[b]&&d[b].length>0)if(f[b]&&f[b].length>0){var e=new Set(d[b]),k=f[b].filter(function(a){return e.has(a)});k.length>0&&(j(i,a.apiPublisherPlatform),i[b]=k)}else j(i,a.apiPublisherPlatform),i[b]=d[b];else j(i,a.apiPublisherPlatform),i[b]=f[b]});return i}function j(a,c){a[b("AdsAPITargetFields").PUBLISHER_PLATFORMS]?a[b("AdsAPITargetFields").PUBLISHER_PLATFORMS].push(c):a[b("AdsAPITargetFields").PUBLISHER_PLATFORMS]=[c]}e.exports=new a()}),null);